<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Login - H&B Importaciones</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container" style="margin-top: 100px;">
        <h1>Test de Login - H&B Importaciones</h1>
        
        <div class="card" style="max-width: 400px; margin: 0 auto;">
            <div class="card-body">
                <h2>Iniciar Sesión</h2>
                <form id="login-form">
                    <div class="field">
                        <label for="email">Email</label>
                        <input id="email" type="email" required placeholder="tu@correo.com">
                    </div>
                    <div class="field">
                        <label for="password">Contraseña</label>
                        <input id="password" type="password" required placeholder="••••••••">
                    </div>
                    <div class="actions">
                        <button class="btn brand" type="submit">Iniciar Sesión</button>
                    </div>
                </form>
                
                <div style="margin-top: 20px;">
                    <h3>Usuarios Demo:</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <button class="btn secondary" onclick="fillUser('admin')">Admin</button>
                        <button class="btn secondary" onclick="fillUser('distributor')">Distribuidor</button>
                        <button class="btn secondary" onclick="fillUser('client')">Cliente</button>
                    </div>
                </div>
                
                <div id="result" style="margin-top: 20px; padding: 10px; background: #f3f4f6; border-radius: 8px; display: none;">
                    <h4>Resultado:</h4>
                    <p id="result-text"></p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/auth-simple.js"></script>
    <script>
        // Usuarios demo
        const demoUsers = {
            admin: { email: 'admin@hb.local', password: 'admin123', name: 'Administrador', role: 'admin' },
            distributor: { email: 'distri@hb.local', password: 'distri123', name: 'Distribuidora', role: 'distributor' },
            client: { email: 'cliente@hb.local', password: 'cliente123', name: 'Cliente', role: 'client' }
        };

        function fillUser(type) {
            const user = demoUsers[type];
            if (user) {
                document.getElementById('email').value = user.email;
                document.getElementById('password').value = user.password;
                showResult(`Datos de ${user.name} cargados`, 'info');
            }
        }

        function showResult(message, type = 'info') {
            const result = document.getElementById('result');
            const resultText = document.getElementById('result-text');
            result.style.display = 'block';
            resultText.textContent = message;
            result.style.background = type === 'error' ? '#fee2e2' : type === 'success' ? '#d1fae5' : '#f3f4f6';
        }

        // Override del redirectByRole para mostrar resultado
        const originalRedirect = window.redirectByRole;
        window.redirectByRole = function(user) {
            showResult(`¡Bienvenido, ${user.name}! Rol: ${user.role}. Redirigiendo a ${user.role === 'admin' ? 'admin' : user.role === 'distributor' ? 'distri' : 'user'}...`, 'success');
            
            // Simular redirección después de 2 segundos
            setTimeout(() => {
                if (originalRedirect) {
                    originalRedirect(user);
                }
            }, 2000);
        };

        // Mostrar sesión actual si existe
        const sessionData = localStorage.getItem('hb_session');
        if (sessionData) {
            try {
                const session = JSON.parse(sessionData);
                showResult(`Sesión activa: ${session.name} (${session.role})`, 'info');
            } catch (e) {
                showResult('Sesión inválida', 'error');
            }
        }
    </script>
</body>
</html>
